<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <!-- 
          MAIN DATA STRUCTURES
        
            Tune
              lines[]
                staffs[]
                   voices[]

            Printer
              layouter  Layout {}
              staffgroups[] Staffgroup {}

            Layout 
              Staffgroup {}
                 voices[]
                   beams[]
                   children[]
                   otherchildren[]
                   stave {}

            stave {}
               y
               top
               bottom
               highest
               lowest
        
           TODO:
             done: Verificar o transporte de keys com modos min e maj
             done: Verificar os limites máximo e mínimos para transporte de keys
             done: Ignorar Accents na transposição
             done: Tablatura: gerar mesmo sem o baixo
             done: Layout:    Revisar a impressão dos elementos ending, accents e lyrics
             done: Layout:    Revisar a de linhas de texto, quando há mais de uma linha
        
             Tablatura: melhorar a relação open/close do fole na melodia
             Tablatura: imprimir os de pausas adequadamente no baixo
             Tablatura: combinar tempos de notas da melodia com notas do baixo
             Tablatura: revisar a impressão de múltiplas notas na mesma coluna
        -->
	<title>Draw The Dots: Tune Editor demo</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"></meta>
    </head>
    <body>

	<script type="text/javascript" src="proto_noconflict.js" ></script>

        <script type="text/javascript" src="data/abc_tune.js" ></script>
	<script type="text/javascript" src="api/abc_tunebook.js" ></script>
        <script type="text/javascript" src="midi/abc_midiwriter.js" ></script>

        <script type="text/javascript" src="write/raphael.js" ></script>
	<script type="text/javascript" src="write/sprintf.js" ></script>
        <script type="text/javascript" src="write/abc_glyphs.js" ></script>
        <script type="text/javascript" src="write/abc_graphelements.js" ></script>
        <script type="text/javascript" src="write/abc_layout.js" ></script>
        <script type="text/javascript" src="write/abc_write.js" ></script>

        <script type="text/javascript" src="parse/abc_parse_header.js" ></script>
	<script type="text/javascript" src="parse/abc_tokenizer.js" ></script>
	<script type="text/javascript" src="parse/abc_parse_key_voice.js" ></script>
	<script type="text/javascript" src="parse/abc_parse_directive.js" ></script>
        <script type="text/javascript" src="parse/abc_parse.js" ></script>
        <script type="text/javascript" src="parse/abc_transport.js" ></script>
	<script type="text/javascript" src="parse/abc_common.js" ></script>

        <!-- modelos de gaitas disponíveis -->
        <script type="text/javascript" src="tablature/accordion.hohner.gc.js"></script>
        <script type="text/javascript" src="tablature/accordion.hohner.clubIIIM.br.js"></script>
        <script type="text/javascript" src="tablature/accordion_map.js"></script>
        
 	<script type="text/javascript" src="edit/abc_editor.js" ></script>
        
        <!--applet id="MIDIPlugin" code="MIDIPlugin.class" name="MIDIPlugin" archive="http://dl.dropbox.com/u/223827/abcjs/MIDIPlugin.jar" height="1" width="1"></applet-->
        <!--applet id="MIDIPlugin" code="MIDIPlugin.class" name="MIDIPlugin" archive="MIDIPlugin.jar" height="2" width="1"></applet-->
        <!--textarea id="target" cols="80" rows="15"></textarea-->

        <select id="selGaitas" ></select>
        <select id="selKey" ></select>
        <input type="submit" id="maisOitava" value="+ Oitava" onclick="javascript:doTranspose(12);"></input>
        <input type="submit" id="maisMeioTom" value="+ 1/2 Tom" onclick="javascript:doTranspose(1);"></input>
        <input type="submit"  id="nenosMeioTom" value="- 1/2 Tom" onclick="javascript:doTranspose(-1);"></input>
        <input type="submit" id="menosOitava" value="- Oitava" onclick="javascript:doTranspose(-12);"></input>
        <input type="submit" id="forceRefresh" value="Refresh" onclick="javascript:doForceRefresh();"></input>
        <input type="checkbox" id="chkAutoRefresh"></input>Auto refresh 
        <input type="checkbox" id="chkDebug" onclick="javascript:doCheckDebug();"></input>Debug

<textarea id="abcx" cols="120" rows="10" style="display:none; float:left;">
%%scale 1.0
X:1
T:J'ai vu le loup, le renard et la belette
T:Eu vi o lobo, a raposa e a doninha
C:Tradicional 
C:(transcrição: Bernard Loffet)
Q:"Allegro" 1/4=164
L:1/8
M:2/4
V:melodia
K:C treble 
|: !pp! "C"[c2e2g2]BA | "F"[G2B2]AB |1 +<(+ "G"cBcd +<)+ !fermata! ||2  +>(+ e2c2 +>)+ | c2BA | G2AB | c2d2 | c2z2  :|
w:X'ai vu le loup la re-nard la ba-le-tte * J'ai  vu le loup la  re-nard dan-ser
w:X'ai vu le loup la re-nard la ba-le-tte * J'ai  vu le loup la  re-nard dan-ser
w:X'ai vu le loup la re-nard la ba-le-tte * J'ai  vu le loup la  re-nard dan-ser
%|: c2d2 | e2f2 | e2d2 | e2z2 |  c2cB | A2AG | A2B2 |1 A2G2 :|2 c2z2  | 
V:baixo
K:C bass
|: C,2[C,2E,2G,2] | C,2[G,,2B,,2D,2] | G,,2[G,,2B,,2D,2] | C,2[C,2E,2G,2] | C,2[C,2E,2G,2] \
| F,,2[F,,2A,,2C,2] | G,,2[G,,2B,,2D,2] | C,2[C,2E,2G,2] :|
</textarea>

<textarea id="abcx" cols="120" rows="10" style="display:none; float:left;">
%%scale 1.0
X:1
T:J'ai vu le loup, le renard et la belette
T:Eu vi o lobo, a raposa e a doninha
C:Tradicional 
C:(transcrição: Bernard Loffet)
Q:"Allegro" 1/4=164
L:1/8
M:2/4
V:melodia
K:C treble 
%|: [c2e2g2]BA | [G2B2]AB | +<(+ cBcd +<)+|  +>(+ e2c2 +>)+ | c2BA | G2AB | c2d2 | c2z2  :|
|: !pp! [c2e2g2]BA | [G2B2]AB |  cBcd |  e2c2  | c2BA | G2AB | c2d2 | c2z2  :|
w:J'ai vu le loup la re-nard la ba-le-tte * J'ai  vu le loup la  re-nard dan-ser
%|: c2d2 | e2f2 | e2d2 | e2z2 |  c2cB | A2AG | A2B2 |1 A2G2 :|2 c2z2  | 
|: c2d2 | e2f2 | e2d2 | e2z2 |1 +<(+ c2c'B | A2AG | A2B2 +<)+| +>(+ A2G2 +>)+ :|2 c2z2  | 
w:J'ai vu le loup la re-nard la ba-le-tte * J'ai  vu le loup la  re-nard dan-ser
V:baixo
K:C bass
|: C,2[C,2E,2G,2] | C,2[G,,2B,,2D,2] | G,,2[G,,2B,,2D,2] | C,2[C,2E,2G,2] | C,2[C,2E,2G,2] \
| F,,2[F,,2A,,2C,2] | G,,2[G,,2B,,2D,2] | C,2[C,2E,2G,2] :|
|: C,2[C,2E,2G,2] | F,,2[F,,2A,,2C,2] | G,,2[G,,2B,,2D,2] | C,2[C,2E,2G,2] | C,2[C,2E,2G,2] \
| F,,2[F,,2A,,2C,2] | F,,2[F,,2A,,2C,2] | G,,2[G,,2B,,2D,2] :| C,2[C,2E,2G,2] |
V:tablatura
K:none accordionTab
</textarea>

<textarea id="abc" cols="120" rows="10" style="display:true; float:left;">
X:1
T:Maitia, nun zira?
C:Folclore Basco
C:versão de José Uruñuela.
N:Transcrito por Flávio
L:1/8
Q:"Allegro" 1/4=118
M:6/8
K:G
V:melodia
|z4zB |: B2A A2G | G3-Gz A | B2B B2c | d3 d2B | A2A A2B | c3 B2B |
w:Mai ti a nun zi ra * Nik et zu tuk i kuz ten ez be ti rik ja ki ten Nu
| B2A (AG)F |1 G6 | z4 z B :|2 G6 | d3 efg | B3 A3 | G6 | z4zd |
w:rat gal du * zi ra 
|: g2g g2f | e3 e3 | fga f2e | d4zc | B2B B2c | d3 d2B | A2A A2B |
| c3 B2B | B2A AGF |1 G4zd :|2 G6 | d3 efg | B3 A3 | G6 | z4zB |
%V:baixo
%K:G bass
%|z6 |:z6 |z6 | z6 |z6 | z6 | z6 |
%| z6  |z6  | z6  :| z6 | z6  | z6  | z6 | z6  |
%|: z6  | z6 | z6  | z6  | z6  | z6  | z6 |
%| z6  | z6  | z6  :|z6 | z6  | z6  | z6  | z6  |
V:tablatura
K:none accordionTab
</textarea>

        <div id="warnings"></div>
        <div id="midi"></div>
        <div id="canvas" style="overflow-y: scroll; float:left;"></div>

        <script type="text/javascript">
            
                window.myEditor = {};


                window.onload = function() {
                    debug=false;
                    myEditor = new ABCJS.Editor(
                            "abc", { 
                                 canvas_id: "canvas"
                                //,midi_id: "midi"
                                ,warnings_id: "warnings"
                                ,refreshController_id: "chkAutoRefresh"
                                ,accordionSelector_id: "selGaitas"
                                ,keySelector_id: "selKey"
                                ,midi_options:{ program:21, qpm:150, type:"qt" }
                                ,render_options:{}
                                ,gui: false
                             });
                };
                
                function doTranspose( value ) {
                    myEditor.fireChanged(value, "force" );
                }
                
                function doForceRefresh() {
                    myEditor.fireChanged( 0, "force" );
                }
                function doCheckDebug() {
                    debug=document.getElementById("chkDebug").checked;
                    myEditor.fireChanged( 0, "force" );
                }
                
        </script>

    </body>
</html>
